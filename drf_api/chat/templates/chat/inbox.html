{% extends 'base.html' %} {% block content %}
<div class="flex h-full">
  <!-- Sidebar -->
  <div class="w-1/3 border-r bg-white p-4 overflow-y-auto">
    <h2 class="text-xl font-bold mb-4">Users</h2>
    <ul>
      {% for u in users %}
      <li class="mb-2">
        <a
          href="{% url 'start_chat' u.id %}"
          class="block p-2 rounded hover:bg-gray-100"
        >
          {{ u.username }}
        </a>
      </li>
      {% endfor %}
    </ul>
  </div>

  <!-- Inbox List -->
  <div class="w-2/3 p-4 overflow-y-auto">
    <h2 class="text-xl font-bold mb-4">Conversations</h2>
    <div class="space-y-2">
      {% for item in conversations_with_other_user %}
      <a
        href="{% url 'chat_detail' item.conversation.id %}"
        class="block p-4 bg-white rounded shadow hover:bg-blue-50"
      >
        <div class="flex justify-between">
          <span class="font-bold"
            >{{ item.other_user.username|default:"Unknown User" }}</span
          >
          <span class="text-gray-400 text-sm"
            >{{ item.conversation.updated_at|date:"M d, H:i" }}</span
          >
        </div>
        <div class="text-gray-600 truncate">
          {% if item.conversation.messages.last %} {{ item.conversation.messages.last.content }} {% else %} No messages yet
          {% endif %}
        </div>
      </a>
      {% empty %}
      <p>No conversations yet.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
